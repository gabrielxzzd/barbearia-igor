<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Meta tags para SEO -->
    <meta name="description" content="Barbershop Igor em Nazareno - MG. Oferecemos cortes de cabelo, barba, e produtos de alta qualidade. Agende seu hor√°rio e tenha uma experi√™ncia √∫nica.">
    <meta name="keywords" content="barbearia, barbershop, Nazareno, MG, corte de cabelo, barba, agendamento, Igor Silva">
    <meta name="author" content="Barbershop Igor">
    
    <!-- Open Graph Meta Tags para compartilhamento social -->
    <meta property="og:title" content="BARBERSHOP IGOR - Sua Barbearia em Nazareno">
    <meta property="og:description" content="Estilo e precis√£o em cada corte. Qualidade e atendimento que voc√™ merece.">
    <meta property="og:image" content="https://i.imgur.com/rSIUamO.jpeg">
    <meta property="og:url" content="https://seusite.com.br">
    <meta property="og:type" content="website">

    <title>BARBERSHOP IGOR - Sua Barbearia em Nazareno</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíà</text></svg>">
    
    <!-- Carregamento de fontes e CSS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Bebas+Neue&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Inter', sans-serif; 
            padding-bottom: 140px; /* Espa√ßo para o carrinho flutuante */
        }
        .font-bebas { font-family: 'Bebas Neue', sans-serif; }
        .hero-bg {
            background-image: url('https://images.unsplash.com/photo-1599351431202-145d8d3207ac?q=80&w=1974&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        /* Estilo do checkbox personalizado */
        .form-checkbox {
            appearance: none;
            -webkit-appearance: none;
            height: 1.25rem;
            width: 1.25rem;
            border: 2px solid #4a5568;
            border-radius: 0.25rem;
            background-color: #2d3748;
            cursor: pointer;
            position: relative;
            transition: all 0.2s;
        }
        .form-checkbox:checked {
            background-color: #f59e0b; /* amber-500 */
            border-color: #f59e0b;
        }
        .form-checkbox:checked::after {
            content: '‚úì';
            font-size: 1rem;
            color: black;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
        /* Anima√ß√£o para itens da galeria e testemunhos */
        .fade-in-up {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease-out, transform 0.5s ease-out;
        }
        .fade-in-up.visible {
            opacity: 1;
            transform: translateY(0);
        }
         /* Estilos do Modal */
        .modal {
            transition: opacity 0.3s ease-in-out;
        }
        .modal-content {
            animation: zoomIn 0.3s ease-out;
        }
        @keyframes zoomIn {
            from { transform: scale(0.8); }
            to { transform: scale(1); }
        }
    </style>

    <!-- Schema Markup para SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BarberShop",
      "name": "BARBERSHOP IGOR",
      "image": "https://i.imgur.com/MmjoXSf.png",
      "url": "https://seusite.com.br", 
      "telephone": "+553599458955",
      "priceRange": "$$",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "Rua Jo√£o Pio, 17",
        "addressLocality": "Nazareno",
        "addressRegion": "MG",
        "postalCode": "36370-000",
        "addressCountry": "BR"
      },
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": -21.4262145,
        "longitude": -44.6111789
      },
      "openingHoursSpecification": [
        {
          "@type": "OpeningHoursSpecification",
          "dayOfWeek": [
            "Tuesday",
            "Wednesday",
            "Thursday",
            "Friday"
          ],
          "opens": "08:00",
          "closes": "20:00"
        },
        {
          "@type": "OpeningHoursSpecification",
          "dayOfWeek": "Saturday",
          "opens": "08:30",
          "closes": "20:00"
        }
      ]
    }
    </script>
</head>
<body class="bg-zinc-900 text-white">

    <!-- Header -->
    <header class="bg-black/80 backdrop-blur-sm fixed w-full top-0 z-50 shadow-lg">
        <div class="container mx-auto flex justify-between items-center p-4">
            <a href="#home">
                <img src="https://i.imgur.com/lLzf8I0.png" alt="Logo da Barbearia Igor" class="h-12 w-auto" onerror="this.onerror=null;this.src='https://placehold.co/150x50/1a1a1a/f59e0b?text=BARBERSHOP+IGOR';">
            </a>
            <nav class="hidden lg:flex space-x-6 text-sm items-center">
                 <a href="#promotions" class="hover:text-amber-400 transition duration-300">Promo√ß√µes</a>
                 <a href="#services" class="hover:text-amber-400 transition duration-300">Servi√ßos</a>
                 <a href="#scheduling" class="hover:text-amber-400 transition duration-300">Agendamento</a>
                 <a href="#gallery" class="hover:text-amber-400 transition duration-300">Galeria</a>
                 <a href="#testimonials" class="hover:text-amber-400 transition duration-300">Depoimentos</a>
                 <a href="#about" class="hover:text-amber-400 transition duration-300">Sobre</a>
                 <a href="#contact" class="hover:text-amber-400 transition duration-300">Contato</a>
            </nav>
            <a href="https://api.whatsapp.com/send?phone=553599458955&text=Ol%C3%A1%21%20Gostaria%20de%20saber%20os%20hor%C3%A1rios%20dispon%C3%ADveis." target="_blank" class="bg-green-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-600 transition duration-300 hidden lg:inline-flex items-center gap-2">
                 <i class="fab fa-whatsapp"></i>
                Agendar
            </a>
            <button id="mobile-menu-button" class="lg:hidden text-white focus:outline-none">
                <i class="fas fa-bars text-2xl"></i>
            </button>
        </div>
        <!-- Menu Mobile -->
        <div id="mobile-menu" class="hidden lg:hidden bg-black/90">
            <a href="#promotions" class="block text-center py-3 hover:bg-amber-400 hover:text-black transition-colors duration-300 menu-link">Promo√ß√µes</a>
            <a href="#services" class="block text-center py-3 hover:bg-amber-400 hover:text-black transition-colors duration-300 menu-link">Servi√ßos</a>
            <a href="#scheduling" class="block text-center py-3 hover:bg-amber-400 hover:text-black transition-colors duration-300 menu-link">Agendamento</a>
            <a href="#gallery" class="block text-center py-3 hover:bg-amber-400 hover:text-black transition-colors duration-300 menu-link">Galeria</a>
            <a href="#testimonials" class="block text-center py-3 hover:bg-amber-400 hover:text-black transition-colors duration-300 menu-link">Depoimentos</a>
            <a href="#about" class="block text-center py-3 hover:bg-amber-400 hover:text-black transition-colors duration-300 menu-link">Sobre</a>
            <a href="#contact" class="block text-center py-3 hover:bg-amber-400 hover:text-black transition-colors duration-300 menu-link">Contato</a>
            <a href="https://api.whatsapp.com/send?phone=553599458955&text=Ol%C3%A1%21%20Gostaria%20de%20saber%20os%20hor%C3%A1rios%20dispon%C3%ADveis." target="_blank" class="block text-center py-4 bg-green-500 text-white font-bold menu-link">Agendar via WhatsApp</a>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="home" class="hero-bg h-[80vh] flex items-center justify-center text-center">
        <div class="bg-black/60 p-8 rounded-lg max-w-4xl mx-4">
            <h2 class="text-5xl md:text-7xl font-bebas tracking-widest text-amber-400">ESTILO E PRECIS√ÉO</h2>
            <p class="text-xl md:text-2xl mt-4">Sua busca pelo corte perfeito termina aqui. Qualidade e atendimento que voc√™ merece.</p>
            <a href="#services" class="mt-8 inline-block bg-amber-400 text-black font-bold py-3 px-8 rounded-lg text-lg hover:bg-amber-500 transition duration-300 transform hover:scale-105">
                Monte seu Pedido
            </a>
        </div>
    </section>

    <!-- Promotions Section -->
    <section id="promotions" class="py-12 bg-amber-400 text-black">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-3xl font-bebas tracking-wider mb-4">PROMO√á√ÉO IMPERD√çVEL!</h2>
            <p class="text-lg mb-6">Aproveite nosso <strong class="font-bold">Combo Mensal</strong> e mantenha o estilo sempre em dia com um pre√ßo especial.</p>
            <a href="#services" class="bg-black text-amber-400 font-bold py-3 px-8 rounded-lg text-lg hover:bg-zinc-800 transition duration-300 transform hover:scale-105">
                Ver Combo Mensal
            </a>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="py-20 bg-zinc-900">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-bebas text-center mb-4 tracking-wider">Nossos Servi√ßos</h2>
            <p class="text-lg text-zinc-400 text-center mb-12 max-w-2xl mx-auto">Selecione os servi√ßos que deseja. Seu pedido aparecer√° na barra inferior da tela.</p>
            <div id="services-list" class="bg-zinc-800 rounded-lg shadow-2xl shadow-black/30 divide-y divide-zinc-700">
                <!-- Servi√ßos inseridos via JS -->
            </div>
        </div>
    </section>
    
    <!-- Products Section -->
    <section id="products" class="py-20 bg-black">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-bebas text-center mb-12 tracking-wider">Nossos Produtos</h2>
            <div id="products-list" class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Produtos inseridos via JS -->
            </div>
        </div>
    </section>

    <!-- Scheduling Section -->
    <section id="scheduling" class="py-20 bg-zinc-900">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-bebas text-center mb-12 tracking-wider text-amber-400">Fa√ßa seu Agendamento</h2>
            <div id="scheduling-container" class="max-w-2xl mx-auto bg-black p-6 rounded-lg shadow-lg transition-all duration-300">
                <!-- Calendar -->
                <div>
                    <div class="flex justify-between items-center mb-4">
                        <button id="prev-month-btn" class="text-amber-400 hover:text-amber-500 transition-colors text-xl"><i class="fas fa-chevron-left"></i></button>
                        <h3 id="month-year-label" class="text-xl font-bebas tracking-wider">Julho 2025</h3>
                        <button id="next-month-btn" class="text-amber-400 hover:text-amber-500 transition-colors text-xl"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    <div id="calendar-grid" class="grid grid-cols-7 gap-1 text-center text-sm">
                        <!-- Calendar days will be inserted here -->
                    </div>
                </div>

                <!-- Professional -->
                <div class="mt-6 text-center">
                    <h3 class="text-xl font-bebas tracking-wider mb-3">Profissional</h3>
                    <div class="inline-block text-center border-2 border-amber-400 rounded-full p-1">
                        <img src="https://i.imgur.com/MmjoXSf.png" alt="Barbeiro Igor" class="w-20 h-20 rounded-full mx-auto">
                        <p class="mt-2 font-bold text-sm">Igor</p>
                    </div>
                </div>

                <!-- Time Slots -->
                <div class="mt-6">
                    <h3 class="text-xl font-bebas tracking-wider text-center mb-3">Hor√°rios Dispon√≠veis</h3>
                    <div id="time-slots-grid" class="grid grid-cols-4 sm:grid-cols-5 gap-2">
                        <!-- Time slots will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Gallery Section -->
    <section id="gallery" class="py-20 bg-black">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-bebas text-center mb-12 tracking-wider text-amber-400">Nossos Trabalhos</h2>
            <div id="gallery-grid" class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <!-- Imagens da galeria inseridas via JS -->
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section id="testimonials" class="py-20 bg-zinc-900">
        <div class="container mx-auto px-4">
            <h2 class="text-4xl font-bebas text-center mb-12 tracking-wider text-amber-400">O que nossos clientes dizem</h2>
            <div id="testimonials-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Depoimentos inseridos via JS -->
            </div>
        </div>
    </section>
    
    <!-- About Section -->
    <section id="about" class="py-20 bg-black">
        <div class="container mx-auto px-4 flex flex-col md:flex-row items-center gap-12">
            <div class="md:w-1/2 fade-in-up">
                <img loading="lazy" src="https://i.imgur.com/MmjoXSf.png" alt="Foto de Igor Silva, o barbeiro" class="rounded-lg shadow-lg w-full" onerror="this.onerror=null;this.src='https://placehold.co/600x600/3f3f46/amber-400?text=Igor+Silva';">
            </div>
            <div class="md:w-1/2 text-center md:text-left fade-in-up">
                <h2 class="text-4xl font-bebas mb-4 tracking-wider text-amber-400">SOBRE A BARBERSHOP IGOR</h2>
                <p class="mb-4 text-lg text-zinc-300">Fundada por Igor Silva, a Barbershop Igor nasceu da paix√£o pela arte da barbearia cl√°ssica com um toque moderno. Nosso compromisso √© oferecer mais do que um simples servi√ßo: proporcionamos uma experi√™ncia completa de cuidado masculino, com atendimento personalizado, produtos de alta qualidade e um ambiente acolhedor em Nazareno.</p>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-20 bg-zinc-900">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-4xl font-bebas mb-8 tracking-wider">Contato e Localiza√ß√£o</h2>
            <div class="flex flex-col md:flex-row justify-center items-center gap-8">
                <div class="bg-zinc-800 p-6 rounded-lg shadow-lg w-full md:w-auto transform hover:scale-105 transition-transform duration-300">
                    <i class="fab fa-whatsapp text-5xl text-green-500 mb-4"></i>
                    <h3 class="text-2xl font-bold mb-2">WhatsApp</h3>
                    <p class="text-lg text-zinc-300 mb-4">Clique para d√∫vidas ou contato direto.</p>
                    <a href="https://api.whatsapp.com/send?phone=553599458955&text=Ol%C3%A1%21%20Vim%20pelo%20site%20e%20gostaria%20de%20tirar%20uma%20d%C3%BAvida." target="_blank" class="bg-green-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-600 transition duration-300 inline-block">(35) 9945-8955</a>
                </div>
                <div class="bg-zinc-800 p-6 rounded-lg shadow-lg w-full md:w-auto transform hover:scale-105 transition-transform duration-300">
                    <i class="fab fa-instagram text-5xl text-pink-500 mb-4"></i>
                    <h3 class="text-2xl font-bold mb-2">Instagram</h3>
                    <p class="text-lg text-zinc-300 mb-4">Confira nossos trabalhos mais recentes!</p>
                    <a href="https://www.instagram.com/barbershopigorsilva/" target="_blank" class="bg-pink-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-pink-600 transition duration-300 inline-block">@barbershopigorsilva</a>
                </div>
            </div>
            <div class="mt-12">
                <h3 class="text-2xl font-bold mb-2">Nosso Endere√ßo</h3>
                <p class="text-lg text-zinc-300">Rua Jo√£o Pio, 17, Centro, Nazareno - MG</p>
                <div class="mt-4 w-full h-80 rounded-lg overflow-hidden shadow-lg">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3714.073289456251!2d-44.61117892574163!3d-21.42621457999885!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9fd372370213197%3A0x6b133c9429712954!2sR.%20Jo%C3%A3o%20Pio%2C%2017%2C%20Nazareno%20-%20MG%2C%2036370-000!5e0!3m2!1spt-BR!2sbr!4v1718228352695!5m2!1spt-BR!2sbr" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" title="Localiza√ß√£o da Barbearia Igor no Google Maps"></iframe>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-zinc-800 text-center py-6 relative">
        <div class="container mx-auto">
            <p>&copy; 2024 BARBERSHOP IGOR. Todos os direitos reservados.</p>
        </div>
    </footer>

    <!-- Floating Cart Summary -->
    <div id="cart-summary" class="fixed bottom-0 left-0 right-0 bg-black/90 backdrop-blur-sm p-4 transform translate-y-full transition-transform duration-300 z-40">
        <div class="container mx-auto flex justify-between items-center">
            <div>
                <h3 class="font-bold text-lg text-amber-400">Seu Pedido:</h3>
                <p id="cart-total" class="text-white font-semibold">Total: R$ 0,00</p>
                <p id="cart-items-count" class="text-xs text-zinc-400">Nenhum item selecionado</p>
            </div>
            <button id="checkout-button" class="bg-green-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-600 transition duration-300 disabled:bg-gray-600 disabled:cursor-not-allowed flex items-center gap-2" disabled>
                <i class="fab fa-whatsapp"></i>
                Finalizar Pedido
            </button>
        </div>
    </div>
    
    <!-- Product Modal -->
    <div id="product-modal" class="fixed inset-0 bg-black/80 z-50 items-center justify-center hidden opacity-0 modal">
        <div class="modal-content bg-zinc-900 p-6 rounded-lg shadow-lg relative w-11/12 md:w-1/3 text-center">
            <button id="modal-close-button" class="absolute -top-3 -right-3 bg-white text-black rounded-full h-8 w-8 flex items-center justify-center text-xl font-bold">&times;</button>
            <img id="modal-product-image" src="" alt="" class="rounded-lg w-full h-48 object-cover mb-4">
            <h3 id="modal-product-title" class="text-2xl font-bold text-amber-400 mb-2"></h3>
            <p id="modal-product-description" class="text-zinc-300 mb-4"></p>
            <p class="text-2xl font-bold mb-4" id="modal-product-price"></p>
            <button id="modal-add-to-cart-button" class="mt-auto bg-amber-500 text-black font-bold py-2 px-4 rounded-lg hover:bg-amber-600 transition cursor-pointer w-full">Adicionar ao Pedido</button>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="fixed inset-0 bg-black/80 z-50 items-center justify-center hidden opacity-0 modal">
        <div class="modal-content bg-zinc-900 p-6 rounded-lg shadow-lg relative w-11/12 md:w-1/3">
            <h3 class="text-2xl font-bebas tracking-wider text-amber-400 mb-4 text-center">Confirmar Agendamento</h3>
            <div class="space-y-2 mb-4">
                <input type="text" id="client-name" placeholder="Seu Nome Completo" class="w-full p-2 rounded bg-zinc-700 text-white border border-zinc-600" required>
                <input type="tel" id="client-phone" placeholder="Seu Telefone (WhatsApp)" class="w-full p-2 rounded bg-zinc-700 text-white border border-zinc-600" required>
            </div>
            <div id="confirmation-summary">
                <!-- Summary will be injected here -->
            </div>
            <div class="flex justify-end gap-4 mt-6">
                <button id="cancel-confirmation-btn" class="bg-zinc-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-zinc-700 transition">Voltar</button>
                <button id="confirm-booking-btn" class="bg-green-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-600 transition">Confirmar e Agendar</button>
            </div>
        </div>
    </div>


    <!-- Bot√£o "Voltar ao Topo" -->
    <button id="back-to-top" class="fixed bottom-24 right-5 bg-amber-400 text-black p-3 rounded-full shadow-lg hover:bg-amber-500 transition-all duration-300 opacity-0 scale-0 z-50">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script type="module">
        // Importa√ß√µes do Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, doc, onSnapshot, addDoc, deleteDoc, query, where } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        document.addEventListener('DOMContentLoaded', () => {
            
            let db, auth, appointmentsCollection;

            // --- Constantes e Vari√°veis ---
            const elements = {
                servicesList: document.getElementById('services-list'),
                productsList: document.getElementById('products-list'),
                galleryGrid: document.getElementById('gallery-grid'),
                testimonialsGrid: document.getElementById('testimonials-grid'),
                cartSummary: document.getElementById('cart-summary'),
                cartTotal: document.getElementById('cart-total'),
                cartItemsCount: document.getElementById('cart-items-count'),
                checkoutButton: document.getElementById('checkout-button'),
                mobileMenuButton: document.getElementById('mobile-menu-button'),
                mobileMenu: document.getElementById('mobile-menu'),
                menuLinks: document.querySelectorAll('.menu-link'),
                backToTopButton: document.getElementById('back-to-top'),
                productModal: document.getElementById('product-modal'),
                modalCloseButton: document.getElementById('modal-close-button'),
                modalProductImage: document.getElementById('modal-product-image'),
                modalProductTitle: document.getElementById('modal-product-title'),
                modalProductDescription: document.getElementById('modal-product-description'),
                modalProductPrice: document.getElementById('modal-product-price'),
                modalAddToCartButton: document.getElementById('modal-add-to-cart-button'),
                calendarGrid: document.getElementById('calendar-grid'),
                monthYearLabel: document.getElementById('month-year-label'),
                prevMonthBtn: document.getElementById('prev-month-btn'),
                nextMonthBtn: document.getElementById('next-month-btn'),
                timeSlotsGrid: document.getElementById('time-slots-grid'),
                confirmationModal: document.getElementById('confirmation-modal'),
                confirmationSummary: document.getElementById('confirmation-summary'),
                cancelConfirmationBtn: document.getElementById('cancel-confirmation-btn'),
                confirmBookingBtn: document.getElementById('confirm-booking-btn'),
                clientNameInput: document.getElementById('client-name'),
                clientPhoneInput: document.getElementById('client-phone'),
                schedulingContainer: document.getElementById('scheduling-container'),
            };

            const phoneNumber = "553599458955";

            const data = {
                services: [
                    { id: 'serv1', name: 'Corte de Cabelo', price: 30.00 },
                    { id: 'serv2', name: 'Barba', price: 20.00 },
                    { id: 'serv3', name: 'Sobrancelha', price: 5.00 },
                    { id: 'serv4', name: 'Combo (Corte, Barba e Sobrancelha)', price: 50.00 },
                    { id: 'serv5', name: 'Pezinho', price: 10.00 },
                    { id: 'serv6', name: 'Pigmenta√ß√£o', price: 100.00 },
                    { id: 'serv7', name: 'Platinado', price: 100.00 },
                    { id: 'serv8', name: 'Combo Mensal (Cabelo, Barba e Sobrancelha)', price: 170.00, highlight: 'Mais Pedido' },
                ],
                products: [
                    { id: 'prod1', name: 'Pomada Modeladora', description: 'Efeito matte, alta fixa√ß√£o.', price: 45.00, img: 'https://placehold.co/300x300/3f3f46/amber-400?text=Pomada' },
                    { id: 'prod2', name: 'Balm para Barba', description: 'Hidrata, amacia e alivia a coceira.', price: 50.00, img: 'https://placehold.co/300x300/3f3f46/amber-400?text=Balm' },
                    { id: 'prod3', name: 'Shampoo Fortalecedor', description: 'Limpeza e combate √† queda.', price: 55.00, img: 'https://placehold.co/300x300/3f3f46/amber-400?text=Shampoo' },
                    { id: 'prod4', name: '√ìleo para Barba', description: 'Brilho, maciez e um aroma incr√≠vel.', price: 40.00, img: 'https://placehold.co/300x300/3f3f46/amber-400?text=√ìleo' },
                ],
                gallery: [
                    { src: 'https://i.imgur.com/dtzKRWS.jpeg', alt: 'Corte Moderno' },
                    { src: 'https://i.imgur.com/IXPtx0W.jpeg', alt: 'Barba Alinhada' },
                    { src: 'https://i.imgur.com/rSIUamO.jpeg', alt: 'Platinado' },
                    { src: 'https://i.imgur.com/Vwo6xSG.jpeg', alt: 'Pigmenta√ß√£o' },
                ],
                testimonials: [
                    { name: 'Jo√£o P.', text: 'Atendimento nota 10 e o corte ficou exatamente como eu queria. Virei cliente fiel!', rating: 5 },
                    { name: 'Carlos S.', text: 'Melhor barbearia da regi√£o! Ambiente agrad√°vel e profissionais excelentes.', rating: 5 },
                    { name: 'Lucas M.', text: 'O Igor tem a m√£o boa para a barba. Recomendo a todos que querem um servi√ßo de qualidade.', rating: 5 },
                ]
            };
            
            let cart = [];
            let selectedDate = null;
            let selectedTime = null;
            let currentDate = new Date();
            let bookedTimes = {};
            let unsubscribeAppointments = () => {};

            // --- Fun√ß√µes de Renderiza√ß√£o ---

            const formatCurrency = (value) => `R$ ${value.toFixed(2).replace('.', ',')}`;

            const renderServices = () => {
                if(!elements.servicesList) return;
                elements.servicesList.innerHTML = data.services.map((service, index) => {
                    const highlightBadge = service.highlight 
                        ? `<span class="ml-2 bg-amber-500 text-black text-xs font-bold px-2 py-1 rounded-full align-middle">${service.highlight}</span>` 
                        : '';
                    return `
                    <div class="flex justify-between items-center p-4 ${index % 2 !== 0 ? 'bg-zinc-800/50' : ''}">
                        <label for="${service.id}" class="flex items-center cursor-pointer group flex-1 pr-4">
                            <input type="checkbox" id="${service.id}" class="form-checkbox item-checkbox flex-shrink-0" data-id="${service.id}" data-type="service" aria-label="Selecionar ${service.name}">
                            <span class="ml-4 group-hover:text-amber-400 transition-colors">${service.name}${highlightBadge}</span>
                        </label>
                        <span class="font-semibold text-lg">${formatCurrency(service.price)}</span>
                    </div>
                `}).join('');
            };
            
            const renderProducts = () => {
                if(!elements.productsList) return;
                elements.productsList.innerHTML = data.products.map(product => {
                    const isInCart = cart.some(item => item.id === product.id);
                    const cartButtonClass = isInCart 
                        ? 'bg-red-500 hover:bg-red-600 text-white' 
                        : 'bg-amber-500 hover:bg-amber-600 text-black';
                    const cartButtonText = isInCart ? 'Remover' : 'Adicionar';
                    const cartButtonIcon = isInCart ? 'fa-times' : 'fa-cart-plus';

                    return `
                    <div class="bg-zinc-800 rounded-lg text-center p-4 shadow-lg flex flex-col transform hover:-translate-y-2 transition-transform duration-300 fade-in-up">
                        <img loading="lazy" src="${product.img}" alt="${product.name}" class="rounded-md mb-4 w-full h-32 object-cover">
                        <h3 class="font-bold text-lg text-amber-400 mb-2 h-12 flex items-center justify-center">${product.name}</h3>
                        <p class="text-xl font-bold mt-2 mb-4">${formatCurrency(product.price)}</p>
                        <div class="mt-auto flex flex-col sm:flex-row gap-2">
                            <button class="add-to-cart-button ${cartButtonClass} font-bold py-2 px-3 rounded-lg transition cursor-pointer w-full flex items-center justify-center gap-2" data-id="${product.id}">
                                <i class="fas ${cartButtonIcon} text-sm"></i>
                                <span class="button-label text-sm">${cartButtonText}</span>
                            </button>
                             <button class="view-details-button bg-zinc-700 text-white font-bold py-2 px-3 rounded-lg hover:bg-zinc-600 transition cursor-pointer w-full text-sm" data-id="${product.id}">
                                Detalhes
                            </button>
                        </div>
                    </div>
                `}).join('');
            };

            const renderGallery = () => {
                if (!elements.galleryGrid) return;
                elements.galleryGrid.innerHTML = data.gallery.map(image => `
                    <div class="fade-in-up group relative overflow-hidden rounded-lg shadow-lg">
                        <img loading="lazy" src="${image.src}" alt="${image.alt}" class="w-full h-full object-cover transform group-hover:scale-110 transition duration-500">
                        <div class="absolute inset-0 bg-black/60 group-hover:bg-black/20 transition duration-500 flex items-end justify-start p-4">
                            <p class="text-lg font-bold opacity-0 group-hover:opacity-100 transition-opacity duration-500">${image.alt}</p>
                        </div>
                    </div>
                `).join('');
            }

            const renderTestimonials = () => {
                if (!elements.testimonialsGrid) return;
                elements.testimonialsGrid.innerHTML = data.testimonials.map(testimonial => `
                    <div class="bg-black p-6 rounded-lg shadow-lg fade-in-up">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 rounded-full bg-amber-400 flex items-center justify-center text-black font-bold text-xl mr-4">${testimonial.name.charAt(0)}</div>
                            <div>
                                <h4 class="font-bold text-lg">${testimonial.name}</h4>
                                <div class="text-amber-400">
                                    ${'‚òÖ'.repeat(testimonial.rating)}${'‚òÜ'.repeat(5 - testimonial.rating)}
                                </div>
                            </div>
                        </div>
                        <p class="text-zinc-300">‚Äú${testimonial.text}‚Äù</p>
                    </div>
                `).join('');
            }

            // --- L√≥gica de Agendamento ---
            const renderCalendar = () => {
                const month = currentDate.getMonth();
                const year = currentDate.getFullYear();
                elements.monthYearLabel.textContent = `${new Date(year, month).toLocaleString('pt-BR', { month: 'long', year: 'numeric' })}`;
                
                const firstDayOfMonth = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();

                elements.calendarGrid.innerHTML = '';
                const weekDays = ['D', 'S', 'T', 'Q', 'Q', 'S', 'S'];
                weekDays.forEach(day => {
                    elements.calendarGrid.innerHTML += `<div class="font-bold text-amber-400 text-xs">${day}</div>`;
                });

                for (let i = 0; i < firstDayOfMonth; i++) {
                    elements.calendarGrid.innerHTML += '<div></div>';
                }

                for (let i = 1; i <= daysInMonth; i++) {
                    const dayDate = new Date(year, month, i);
                    const isToday = dayDate.toDateString() === new Date().toDateString();
                    const isSelected = selectedDate && dayDate.toDateString() === selectedDate.toDateString();
                    
                    let dayClasses = 'p-2 rounded-full cursor-pointer hover:bg-amber-500 hover:text-black transition-colors';
                    if (isToday) dayClasses += ' bg-amber-400 text-black';
                    if (isSelected) dayClasses += ' bg-green-500 text-white';

                    elements.calendarGrid.innerHTML += `<div class="${dayClasses}" data-date="${dayDate}">${i}</div>`;
                }
            };

            const renderTimeSlots = () => {
                elements.timeSlotsGrid.innerHTML = '';
                if (!selectedDate) {
                    elements.timeSlotsGrid.innerHTML = '<p class="col-span-full text-center text-zinc-400">Selecione uma data para ver os hor√°rios.</p>';
                    return;
                }

                const dayOfWeek = selectedDate.getDay(); // 0 = Domingo, 1 = Segunda

                if (dayOfWeek === 0 || dayOfWeek === 1) { // Domingo ou Segunda
                    elements.timeSlotsGrid.innerHTML = '<p class="col-span-full text-center text-amber-400 font-bold">Fechado neste dia.</p>';
                    return;
                }

                const dailyBookedTimes = bookedTimes[selectedDate?.toISOString().split('T')[0]] || [];
                
                let timeSlots = [];
                if (dayOfWeek >= 2 && dayOfWeek <= 5) { // Ter√ßa a Sexta
                    for (let hour = 8; hour < 20; hour++) {
                        timeSlots.push(`${String(hour).padStart(2, '0')}:00`);
                        timeSlots.push(`${String(hour).padStart(2, '0')}:30`);
                    }
                } else if (dayOfWeek === 6) { // S√°bado
                    timeSlots.push("08:30");
                    for (let hour = 9; hour < 20; hour++) {
                        timeSlots.push(`${String(hour).padStart(2, '0')}:00`);
                        timeSlots.push(`${String(hour).padStart(2, '0')}:30`);
                    }
                }

                timeSlots.forEach(time => {
                    const isSelected = selectedTime === time;
                    const isBooked = dailyBookedTimes.some(booking => booking.time === time);
                    
                    let timeClasses = 'p-2 text-sm rounded-lg cursor-pointer bg-zinc-700 hover:bg-amber-500 hover:text-black transition-colors';
                    if (isSelected) {
                        timeClasses = 'p-2 text-sm rounded-lg cursor-pointer bg-green-500 text-white';
                    } else if (isBooked) {
                        timeClasses = 'p-2 text-sm rounded-lg bg-zinc-800 text-zinc-600 cursor-not-allowed';
                    }

                    elements.timeSlotsGrid.innerHTML += `<div class="${timeClasses}" data-time="${time}" ${isBooked ? 'disabled' : ''}>${time}</div>`;
                });
            };

            // --- L√≥gica do Carrinho ---
            const updateCart = () => {
                const total = cart.reduce((sum, item) => sum + item.price, 0);
                elements.cartTotal.textContent = `Total: ${formatCurrency(total)}`;
                
                const itemCount = cart.length;
                elements.cartItemsCount.textContent = `${itemCount} ${itemCount === 1 ? 'item selecionado' : 'itens selecionados'}`;

                if (itemCount > 0) {
                    elements.cartSummary.classList.remove('translate-y-full');
                } else {
                    elements.cartSummary.classList.add('translate-y-full');
                }

                if (itemCount > 0 && selectedDate && selectedTime) {
                    elements.checkoutButton.disabled = false;
                } else {
                    elements.checkoutButton.disabled = true;
                }
                renderProducts(); // Re-renderiza os produtos para atualizar o estado do bot√£o
            };
            
            const handleServiceSelection = (e) => {
                const checkbox = e.target;
                if (!checkbox.classList.contains('item-checkbox')) return;
                const id = checkbox.dataset.id;
                const item = data.services.find(i => i.id === id);
                const isInCart = cart.some(cartItem => cartItem.id === id);

                if (checkbox.checked && !isInCart) {
                    cart.push(item);
                } else if (!checkbox.checked) {
                    cart = cart.filter(cartItem => cartItem.id !== id);
                }
                updateCart();
            };

            const handleDirectProductAddToCart = (productId) => {
                const isInCart = cart.some(item => item.id === productId);
                if (isInCart) {
                    cart = cart.filter(item => item.id !== productId);
                } else {
                    const item = data.products.find(p => p.id === productId);
                    cart.push(item);
                }
                updateCart();
            };
            
            const generateWhatsAppMessage = (clientName, clientPhone) => {
                let message = `Ol√°, Barbershop Igor! Novo agendamento:\n\n`;
                message += `*Cliente:* ${clientName}\n`;
                message += `*Telefone:* ${clientPhone}\n`;
                message += `*Data:* ${selectedDate.toLocaleDateString('pt-BR')}\n`;
                message += `*Hor√°rio:* ${selectedTime}\n\n`;
                
                const serviceItems = cart.filter(item => data.services.some(s => s.id === item.id));
                const productItems = cart.filter(item => data.products.some(p => p.id === item.id));

                if (serviceItems.length > 0) {
                    message += "*SERVI√áOS:*\n";
                    serviceItems.forEach(item => { message += `- ${item.name} (${formatCurrency(item.price)})\n`; });
                }

                if (productItems.length > 0) {
                    message += "\n*PRODUTOS:*\n";
                    productItems.forEach(item => { message += `- ${item.name} (${formatCurrency(item.price)})\n`; });
                }
                
                const total = cart.reduce((sum, item) => sum + item.price, 0);
                message += `\n*Total do Pedido: ${formatCurrency(total)}*`;

                return encodeURIComponent(message);
            };

            // --- L√≥gica da UI ---
            const openProductModal = (productId) => {
                const product = data.products.find(p => p.id === productId);

                if (!product) return;

                elements.modalProductImage.src = product.img;
                elements.modalProductImage.alt = product.name;
                elements.modalProductTitle.textContent = product.name;
                elements.modalProductDescription.textContent = product.description;
                elements.modalProductPrice.textContent = formatCurrency(product.price);
                
                const isInCart = cart.some(item => item.id === productId);
                elements.modalAddToCartButton.textContent = isInCart ? 'Adicionado ‚úì' : 'Adicionar ao Pedido';
                elements.modalAddToCartButton.disabled = isInCart;
                if (isInCart) {
                    elements.modalAddToCartButton.classList.add('bg-green-500');
                    elements.modalAddToCartButton.classList.remove('bg-amber-500');
                } else {
                    elements.modalAddToCartButton.classList.remove('bg-green-500');
                    elements.modalAddToCartButton.classList.add('bg-amber-500');
                }

                elements.modalAddToCartButton.onclick = () => {
                    handleDirectProductAddToCart(productId);
                    closeProductModal();
                };

                elements.productModal.classList.remove('hidden');
                elements.productModal.classList.add('flex');
                setTimeout(() => elements.productModal.classList.remove('opacity-0'), 10);
                document.body.style.overflow = 'hidden';
            };

            const closeProductModal = () => {
                elements.productModal.classList.add('opacity-0');
                setTimeout(() => {
                    elements.productModal.classList.add('hidden');
                    elements.productModal.classList.remove('flex');
                    document.body.style.overflow = 'auto';
                }, 300);
            };

            const openConfirmationModal = () => {
                if(cart.length === 0) {
                    alert("Por favor, selecione pelo menos um servi√ßo ou produto.");
                    return;
                }
                if(!selectedDate) {
                    alert("Por favor, selecione uma data para o agendamento.");
                    return;
                }
                 if(!selectedTime) {
                    alert("Por favor, selecione um hor√°rio para o agendamento.");
                    return;
                }

                let summaryHtml = `<p class="mb-2"><strong class="text-amber-400">Data:</strong> ${selectedDate.toLocaleDateString('pt-BR')}</p>`;
                summaryHtml += `<p class="mb-4"><strong class="text-amber-400">Hor√°rio:</strong> ${selectedTime}</p>`;
                
                summaryHtml += '<h4 class="font-bold border-t border-zinc-700 pt-2 mt-2">Itens:</h4><ul class="list-disc list-inside mb-4">';
                cart.forEach(item => {
                    summaryHtml += `<li>${item.name} - ${formatCurrency(item.price)}</li>`;
                });
                summaryHtml += '</ul>';

                const total = cart.reduce((sum, item) => sum + item.price, 0);
                summaryHtml += `<p class="text-xl font-bold border-t border-zinc-700 pt-2 mt-2">Total: ${formatCurrency(total)}</p>`;

                elements.confirmationSummary.innerHTML = summaryHtml;

                elements.confirmationModal.classList.remove('hidden');
                elements.confirmationModal.classList.add('flex');
                setTimeout(() => elements.confirmationModal.classList.remove('opacity-0'), 10);
                document.body.style.overflow = 'hidden';
            };

            const closeConfirmationModal = () => {
                elements.confirmationModal.classList.add('opacity-0');
                setTimeout(() => {
                    elements.confirmationModal.classList.add('hidden');
                    elements.confirmationModal.classList.remove('flex');
                    document.body.style.overflow = 'auto';
                }, 300);
            };

            const toggleMobileMenu = () => {
                elements.mobileMenu.classList.toggle('hidden');
            };
            
            const handleScroll = () => {
                if (window.scrollY > 300) {
                    elements.backToTopButton.classList.remove('opacity-0', 'scale-0');
                } else {
                    elements.backToTopButton.classList.add('opacity-0', 'scale-0');
                }
            };

            const scrollToTop = () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
            
            const animateOnScroll = () => {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });

                document.querySelectorAll('.fade-in-up').forEach(item => {
                    observer.observe(item);
                });
            };

            const listenToAppointments = (date) => {
                unsubscribeAppointments(); // Cancela o listener anterior
                const dateString = date.toISOString().split('T')[0];
                const q = query(appointmentsCollection, where("date", "==", dateString));

                unsubscribeAppointments = onSnapshot(q, (querySnapshot) => {
                    bookedTimes[dateString] = [];
                    querySnapshot.forEach((doc) => {
                        bookedTimes[dateString].push({ id: doc.id, ...doc.data() });
                    });
                    renderTimeSlots();
                });
            };

            // --- Event Listeners ---
            function setupEventListeners() {
                elements.confirmBookingBtn.addEventListener('click', async () => {
                    const clientName = elements.clientNameInput.value;
                    const clientPhone = elements.clientPhoneInput.value;

                    if (!clientName || !clientPhone) {
                        alert("Por favor, preencha seu nome e telefone.");
                        return;
                    }

                    const message = generateWhatsAppMessage(clientName, clientPhone);
                    if(message){
                        // Salvar no Firestore
                        const appointment = {
                            date: selectedDate.toISOString().split('T')[0],
                            time: selectedTime,
                            clientName,
                            clientPhone,
                            services: cart.filter(item => item.id.startsWith('serv')).map(item => item.name),
                            products: cart.filter(item => item.id.startsWith('prod')).map(item => item.name),
                            total: cart.reduce((sum, item) => sum + item.price, 0),
                            userId: auth.currentUser.uid,
                            createdAt: new Date(),
                        };
                        try {
                            await addDoc(appointmentsCollection, appointment);
                        } catch (e) {
                            console.error("Erro ao adicionar documento: ", e);
                        }

                        // Enviar para o WhatsApp
                        const whatsappURL = `https://api.whatsapp.com/send?phone=${phoneNumber}&text=${message}`;
                        window.open(whatsappURL, '_blank');
                    }
                    closeConfirmationModal();
                });

                elements.checkoutButton.addEventListener('click', openConfirmationModal);
                elements.cancelConfirmationBtn.addEventListener('click', closeConfirmationModal);
                
                elements.servicesList?.addEventListener('change', handleServiceSelection);
                
                elements.productsList?.addEventListener('click', (e) => {
                    const detailsButton = e.target.closest('.view-details-button');
                    const addButton = e.target.closest('.add-to-cart-button');

                    if (detailsButton) {
                        openProductModal(detailsButton.dataset.id);
                    } else if (addButton) {
                        handleDirectProductAddToCart(addButton.dataset.id);
                    }
                });

                elements.modalCloseButton.addEventListener('click', closeProductModal);
                elements.productModal.addEventListener('click', (e) => {
                    if (e.target === elements.productModal) {
                        closeProductModal();
                    }
                });
                elements.mobileMenuButton.addEventListener('click', toggleMobileMenu);
                elements.menuLinks.forEach(link => link.addEventListener('click', toggleMobileMenu));
                window.addEventListener('scroll', handleScroll);
                elements.backToTopButton.addEventListener('click', scrollToTop);
                
                elements.prevMonthBtn.addEventListener('click', () => {
                    currentDate.setMonth(currentDate.getMonth() - 1);
                    renderCalendar();
                });

                elements.nextMonthBtn.addEventListener('click', () => {
                    currentDate.setMonth(currentDate.getMonth() + 1);
                    renderCalendar();
                });

                elements.calendarGrid.addEventListener('click', (e) => {
                    if (e.target.dataset.date) {
                        selectedDate = new Date(e.target.dataset.date);
                        selectedTime = null; // Reset time when date changes
                        renderCalendar();
                        listenToAppointments(selectedDate);
                        updateCart();
                    }
                });

                elements.timeSlotsGrid.addEventListener('click', async (e) => {
                    const timeSlot = e.target.closest('[data-time]');
                    if (!timeSlot || timeSlot.hasAttribute('disabled')) return;
                    selectedTime = timeSlot.dataset.time;
                    renderTimeSlots();
                    updateCart();
                });
            }

            // --- Inicializa√ß√£o ---
            async function initializeAppWithFirebase() {
                try {
                    // Configura√ß√£o do Firebase
                    const firebaseConfig = JSON.parse(__firebase_config);
                    const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

                    // Inicializar Firebase
                    const app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    auth = getAuth(app);
                    appointmentsCollection = collection(db, `artifacts/${appId}/public/data/appointments`);
                    
                    if (typeof __initial_auth_token !== 'undefined') {
                        await signInWithCustomToken(auth, __initial_auth_token);
                    } else {
                        await signInAnonymously(auth);
                    }
                    renderCalendar();
                    renderTimeSlots();
                } catch (error) {
                    console.error("Erro na autentica√ß√£o ou inicializa√ß√£o do Firebase:", error);
                    if(elements.schedulingContainer) {
                        elements.schedulingContainer.innerHTML = '<p class="text-center text-red-500">O sistema de agendamento est√° indispon√≠vel no momento. Por favor, tente mais tarde.</p>';
                    }
                }
            }

            renderServices();
            renderProducts();
            renderGallery();
            renderTestimonials();
            animateOnScroll();
            setupEventListeners();
            initializeAppWithFirebase();
        });
    </script>
</body>
</html>
